Text,Token
"/**
 * Licensed to the Apache Software Foundation (ASF) under one
 * or more contributor license agreements.  See the NOTICE file
 * distributed with this work for additional information
 * regarding copyright ownership.  The ASF licenses this file
 * to you under the Apache License, Version 2.0 (the
 * ""License""); you may not use this file except in compliance
 * with the License.  You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an ""AS IS"" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */",Comment
"
",Newline
"
",Newline
package,Keyword
 ,Whitespace
org,Identifier
.,Punctuation
apache,Identifier
.,Punctuation
avro,Identifier
.,Punctuation
mapred,Identifier
.,Punctuation
tether,Identifier
;,Punctuation
"
",Newline
"
",Newline
import,Keyword
 ,Whitespace
java,Identifier
.,Punctuation
io,Identifier
.,Punctuation
IOException,Identifier
;,Punctuation
"
",Newline
import,Keyword
 ,Whitespace
java,Identifier
.,Punctuation
io,Identifier
.,Punctuation
File,Identifier
;,Punctuation
"
",Newline
import,Keyword
 ,Whitespace
java,Identifier
.,Punctuation
net,Identifier
.,Punctuation
InetSocketAddress,Identifier
;,Punctuation
"
",Newline
import,Keyword
 ,Whitespace
java,Identifier
.,Punctuation
net,Identifier
.,Punctuation
URI,Identifier
;,Punctuation
"
",Newline
import,Keyword
 ,Whitespace
java,Identifier
.,Punctuation
util,Identifier
.,Punctuation
ArrayList,Identifier
;,Punctuation
"
",Newline
import,Keyword
 ,Whitespace
java,Identifier
.,Punctuation
util,Identifier
.,Punctuation
List,Identifier
;,Punctuation
"
",Newline
import,Keyword
 ,Whitespace
java,Identifier
.,Punctuation
util,Identifier
.,Punctuation
Map,Identifier
;,Punctuation
"
",Newline
import,Keyword
 ,Whitespace
java,Identifier
.,Punctuation
util,Identifier
.,Punctuation
HashMap,Identifier
;,Punctuation
"
",Newline
"
",Newline
import,Keyword
 ,Whitespace
org,Identifier
.,Punctuation
apache,Identifier
.,Punctuation
hadoop,Identifier
.,Punctuation
io,Identifier
.,Punctuation
NullWritable,Identifier
;,Punctuation
"
",Newline
import,Keyword
 ,Whitespace
org,Identifier
.,Punctuation
apache,Identifier
.,Punctuation
hadoop,Identifier
.,Punctuation
mapred,Identifier
.,Punctuation
JobConf,Identifier
;,Punctuation
"
",Newline
import,Keyword
 ,Whitespace
org,Identifier
.,Punctuation
apache,Identifier
.,Punctuation
hadoop,Identifier
.,Punctuation
mapred,Identifier
.,Punctuation
OutputCollector,Identifier
;,Punctuation
"
",Newline
import,Keyword
 ,Whitespace
org,Identifier
.,Punctuation
apache,Identifier
.,Punctuation
hadoop,Identifier
.,Punctuation
mapred,Identifier
.,Punctuation
Reporter,Identifier
;,Punctuation
"
",Newline
import,Keyword
 ,Whitespace
org,Identifier
.,Punctuation
apache,Identifier
.,Punctuation
hadoop,Identifier
.,Punctuation
mapred,Identifier
.,Punctuation
TaskAttemptID,Identifier
;,Punctuation
"
",Newline
import,Keyword
 ,Whitespace
org,Identifier
.,Punctuation
apache,Identifier
.,Punctuation
hadoop,Identifier
.,Punctuation
mapred,Identifier
.,Punctuation
TaskLog,Identifier
;,Punctuation
"
",Newline
import,Keyword
 ,Whitespace
org,Identifier
.,Punctuation
apache,Identifier
.,Punctuation
hadoop,Identifier
.,Punctuation
filecache,Identifier
.,Punctuation
DistributedCache,Identifier
;,Punctuation
"
",Newline
import,Keyword
 ,Whitespace
org,Identifier
.,Punctuation
apache,Identifier
.,Punctuation
hadoop,Identifier
.,Punctuation
fs,Identifier
.,Punctuation
Path,Identifier
;,Punctuation
"
",Newline
import,Keyword
 ,Whitespace
org,Identifier
.,Punctuation
apache,Identifier
.,Punctuation
hadoop,Identifier
.,Punctuation
fs,Identifier
.,Punctuation
FileUtil,Identifier
;,Punctuation
"
",Newline
"
",Newline
import,Keyword
 ,Whitespace
org,Identifier
.,Punctuation
apache,Identifier
.,Punctuation
avro,Identifier
.,Punctuation
ipc,Identifier
.,Punctuation
Transceiver,Identifier
;,Punctuation
"
",Newline
import,Keyword
 ,Whitespace
org,Identifier
.,Punctuation
apache,Identifier
.,Punctuation
avro,Identifier
.,Punctuation
ipc,Identifier
.,Punctuation
Server,Identifier
;,Punctuation
"
",Newline
import,Keyword
 ,Whitespace
org,Identifier
.,Punctuation
apache,Identifier
.,Punctuation
avro,Identifier
.,Punctuation
ipc,Identifier
.,Punctuation
SaslSocketServer,Identifier
;,Punctuation
"
",Newline
import,Keyword
 ,Whitespace
org,Identifier
.,Punctuation
apache,Identifier
.,Punctuation
avro,Identifier
.,Punctuation
ipc,Identifier
.,Punctuation
SaslSocketTransceiver,Identifier
;,Punctuation
"
",Newline
import,Keyword
 ,Whitespace
org,Identifier
.,Punctuation
apache,Identifier
.,Punctuation
avro,Identifier
.,Punctuation
ipc,Identifier
.,Punctuation
specific,Identifier
.,Punctuation
SpecificRequestor,Identifier
;,Punctuation
"
",Newline
import,Keyword
 ,Whitespace
org,Identifier
.,Punctuation
apache,Identifier
.,Punctuation
avro,Identifier
.,Punctuation
ipc,Identifier
.,Punctuation
specific,Identifier
.,Punctuation
SpecificResponder,Identifier
;,Punctuation
"
",Newline
"
",Newline
import,Keyword
 ,Whitespace
org,Identifier
.,Punctuation
slf4j,Identifier
.,Punctuation
Logger,Identifier
;,Punctuation
"
",Newline
import,Keyword
 ,Whitespace
org,Identifier
.,Punctuation
slf4j,Identifier
.,Punctuation
LoggerFactory,Identifier
;,Punctuation
"
",Newline
"
",Newline
class,Keyword
 ,Whitespace
TetheredProcess,Identifier
  ,Whitespace
{,Punctuation
"
",Newline
"
",Newline
  ,Whitespace
static,Keyword
 ,Whitespace
final,Keyword
 ,Whitespace
Logger,Identifier
 ,Whitespace
LOG,Identifier
 ,Whitespace
=,Operator
 ,Whitespace
LoggerFactory,Identifier
.,Punctuation
getLogger,Identifier
(,Punctuation
TetherMapRunner,Identifier
.,Punctuation
class,Keyword
),Punctuation
;,Punctuation
"
",Newline
"
",Newline
  ,Whitespace
private,Keyword
 ,Whitespace
JobConf,Identifier
 ,Whitespace
job,Identifier
;,Punctuation
"
",Newline
"
",Newline
  ,Whitespace
TetherOutputService,Identifier
 ,Whitespace
outputService,Identifier
;,Punctuation
"
",Newline
  ,Whitespace
Server,Identifier
 ,Whitespace
outputServer,Identifier
;,Punctuation
"
",Newline
  ,Whitespace
Process,Identifier
 ,Whitespace
subprocess,Identifier
;,Punctuation
"
",Newline
  ,Whitespace
Transceiver,Identifier
 ,Whitespace
clientTransceiver,Identifier
;,Punctuation
"
",Newline
  ,Whitespace
InputProtocol,Identifier
 ,Whitespace
inputClient,Identifier
;,Punctuation
"
",Newline
"
",Newline
  ,Whitespace
public,Keyword
 ,Whitespace
TetheredProcess,Identifier
(,Punctuation
JobConf,Identifier
 ,Whitespace
job,Identifier
",",Punctuation
"
",Newline
                          ,Whitespace
OutputCollector,Identifier
<,Operator
TetherData,Identifier
",",Punctuation
 ,Whitespace
NullWritable,Identifier
>,Operator
 ,Whitespace
collector,Identifier
",",Punctuation
"
",Newline
                          ,Whitespace
Reporter,Identifier
 ,Whitespace
reporter,Identifier
),Punctuation
 ,Whitespace
throws,Keyword
 ,Whitespace
Exception,Identifier
 ,Whitespace
{,Punctuation
"
",Newline
    ,Whitespace
try,Keyword
 ,Whitespace
{,Punctuation
"
",Newline
      ,Whitespace
// start server,Comment
"
",Newline
      ,Whitespace
this,Keyword
.,Punctuation
outputService,Identifier
 ,Whitespace
=,Operator
 ,Whitespace
new,Keyword
 ,Whitespace
TetherOutputService,Identifier
(,Punctuation
collector,Identifier
",",Punctuation
 ,Whitespace
reporter,Identifier
),Punctuation
;,Punctuation
"
",Newline
      ,Whitespace
this,Keyword
.,Punctuation
outputServer,Identifier
 ,Whitespace
=,Operator
 ,Whitespace
new,Keyword
 ,Whitespace
SaslSocketServer,Identifier
"
",Newline
        ,Whitespace
(,Punctuation
new,Keyword
 ,Whitespace
SpecificResponder,Identifier
(,Punctuation
OutputProtocol,Identifier
.,Punctuation
class,Keyword
",",Punctuation
 ,Whitespace
outputService,Identifier
),Punctuation
",",Punctuation
"
",Newline
         ,Whitespace
new,Keyword
 ,Whitespace
InetSocketAddress,Identifier
(,Punctuation
0,Literal
),Punctuation
),Punctuation
;,Punctuation
"
",Newline
      ,Whitespace
outputServer,Identifier
.,Punctuation
start,Identifier
(,Punctuation
),Punctuation
;,Punctuation
"
",Newline
      ,Whitespace
"
",Newline
      ,Whitespace
"// start sub-process, connecting back to server",Comment
"
",Newline
      ,Whitespace
this,Keyword
.,Punctuation
subprocess,Identifier
 ,Whitespace
=,Operator
 ,Whitespace
startSubprocess,Identifier
(,Punctuation
job,Identifier
),Punctuation
;,Punctuation
"
",Newline
"
",Newline
      ,Whitespace
// check if the process has exited -- is there a better way to do this?,Comment
"
",Newline
      ,Whitespace
boolean,Keyword
 ,Whitespace
hasexited,Identifier
 ,Whitespace
=,Operator
 ,Whitespace
false,Keyword
;,Punctuation
"
",Newline
      ,Whitespace
try,Keyword
 ,Whitespace
{,Punctuation
"
",Newline
        ,Whitespace
// exitValue throws an exception if process hasn't exited,Comment
"
",Newline
        ,Whitespace
this,Keyword
.,Punctuation
subprocess,Identifier
.,Punctuation
exitValue,Identifier
(,Punctuation
),Punctuation
;,Punctuation
"
",Newline
        ,Whitespace
hasexited,Identifier
 ,Whitespace
=,Operator
 ,Whitespace
true,Keyword
;,Punctuation
"
",Newline
      ,Whitespace
},Punctuation
 ,Whitespace
catch,Keyword
 ,Whitespace
(,Punctuation
IllegalThreadStateException,Identifier
 ,Whitespace
e,Identifier
),Punctuation
 ,Whitespace
{,Punctuation
"
",Newline
      ,Whitespace
},Punctuation
"
",Newline
      ,Whitespace
if,Keyword
 ,Whitespace
(,Punctuation
hasexited,Identifier
),Punctuation
 ,Whitespace
{,Punctuation
"
",Newline
        ,Whitespace
LOG,Identifier
.,Punctuation
error,Identifier
(,Punctuation
"""Could not start subprocess""",String
),Punctuation
;,Punctuation
"
",Newline
        ,Whitespace
throw,Keyword
 ,Whitespace
new,Keyword
 ,Whitespace
RuntimeException,Identifier
(,Punctuation
"""Could not start subprocess""",String
),Punctuation
;,Punctuation
"
",Newline
      ,Whitespace
},Punctuation
"
",Newline
      ,Whitespace
this,Keyword
.,Punctuation
clientTransceiver,Identifier
"
",Newline
        ,Whitespace
=,Operator
 ,Whitespace
new,Keyword
 ,Whitespace
SaslSocketTransceiver,Identifier
(,Punctuation
new,Keyword
 ,Whitespace
InetSocketAddress,Identifier
(,Punctuation
outputService,Identifier
.,Punctuation
inputPort,Identifier
(,Punctuation
),Punctuation
),Punctuation
),Punctuation
;,Punctuation
"
",Newline
      ,Whitespace
this,Keyword
.,Punctuation
inputClient,Identifier
 ,Whitespace
=,Operator
"
",Newline
        ,Whitespace
SpecificRequestor,Identifier
.,Punctuation
getClient,Identifier
(,Punctuation
InputProtocol,Identifier
.,Punctuation
class,Keyword
",",Punctuation
 ,Whitespace
clientTransceiver,Identifier
),Punctuation
;,Punctuation
"
",Newline
"
",Newline
"
",Newline
    ,Whitespace
},Punctuation
 ,Whitespace
catch,Keyword
 ,Whitespace
(,Punctuation
Exception,Identifier
 ,Whitespace
t,Identifier
),Punctuation
 ,Whitespace
{,Punctuation
"
",Newline
      ,Whitespace
close,Identifier
(,Punctuation
),Punctuation
;,Punctuation
"
",Newline
      ,Whitespace
throw,Keyword
 ,Whitespace
t,Identifier
;,Punctuation
"
",Newline
    ,Whitespace
},Punctuation
"
",Newline
  ,Whitespace
},Punctuation
"
",Newline
"
",Newline
  ,Whitespace
public,Keyword
 ,Whitespace
void,Keyword
 ,Whitespace
close,Identifier
(,Punctuation
),Punctuation
 ,Whitespace
{,Punctuation
"
",Newline
    ,Whitespace
if,Keyword
 ,Whitespace
(,Punctuation
clientTransceiver,Identifier
 ,Whitespace
!=,Operator
 ,Whitespace
null,Keyword
),Punctuation
"
",Newline
      ,Whitespace
try,Keyword
 ,Whitespace
{,Punctuation
"
",Newline
        ,Whitespace
clientTransceiver,Identifier
.,Punctuation
close,Identifier
(,Punctuation
),Punctuation
;,Punctuation
"
",Newline
      ,Whitespace
},Punctuation
 ,Whitespace
catch,Keyword
 ,Whitespace
(,Punctuation
IOException,Identifier
 ,Whitespace
e,Identifier
),Punctuation
 ,Whitespace
{,Punctuation
},Punctuation
                  ,Whitespace
// ignore,Comment
"
",Newline
    ,Whitespace
if,Keyword
 ,Whitespace
(,Punctuation
subprocess,Identifier
 ,Whitespace
!=,Operator
 ,Whitespace
null,Keyword
),Punctuation
"
",Newline
      ,Whitespace
subprocess,Identifier
.,Punctuation
destroy,Identifier
(,Punctuation
),Punctuation
;,Punctuation
"
",Newline
    ,Whitespace
if,Keyword
 ,Whitespace
(,Punctuation
outputServer,Identifier
 ,Whitespace
!=,Operator
 ,Whitespace
null,Keyword
),Punctuation
"
",Newline
      ,Whitespace
outputServer,Identifier
.,Punctuation
close,Identifier
(,Punctuation
),Punctuation
;,Punctuation
"
",Newline
  ,Whitespace
},Punctuation
"
",Newline
"
",Newline
  ,Whitespace
private,Keyword
 ,Whitespace
Process,Identifier
 ,Whitespace
startSubprocess,Identifier
(,Punctuation
JobConf,Identifier
 ,Whitespace
job,Identifier
),Punctuation
"
",Newline
    ,Whitespace
throws,Keyword
 ,Whitespace
IOException,Identifier
",",Punctuation
 ,Whitespace
InterruptedException,Identifier
 ,Whitespace
{,Punctuation
"
",Newline
    ,Whitespace
// get the executable command,Comment
"
",Newline
    ,Whitespace
List,Identifier
<,Operator
String,Identifier
>,Operator
 ,Whitespace
command,Identifier
 ,Whitespace
=,Operator
 ,Whitespace
new,Keyword
 ,Whitespace
ArrayList,Identifier
<,Operator
String,Identifier
>,Operator
(,Punctuation
),Punctuation
;,Punctuation
"
",Newline
"
",Newline
    ,Whitespace
String,Identifier
 ,Whitespace
executable,Identifier
=,Operator
"""""",String
;,Punctuation
"
",Newline
    ,Whitespace
if,Keyword
 ,Whitespace
(,Punctuation
job,Identifier
.,Punctuation
getBoolean,Identifier
(,Punctuation
TetherJob,Identifier
.,Punctuation
TETHER_EXEC_CACHED,Identifier
",",Punctuation
false,Keyword
),Punctuation
),Punctuation
{,Punctuation
"
",Newline
      ,Whitespace
//we want to use the cached executable,Comment
"
",Newline
      ,Whitespace
Path,Identifier
[,Punctuation
],Punctuation
 ,Whitespace
localFiles,Identifier
 ,Whitespace
=,Operator
 ,Whitespace
DistributedCache,Identifier
.,Punctuation
getLocalCacheFiles,Identifier
(,Punctuation
job,Identifier
),Punctuation
;,Punctuation
"
",Newline
      ,Whitespace
if,Keyword
 ,Whitespace
(,Punctuation
localFiles,Identifier
 ,Whitespace
==,Operator
 ,Whitespace
null,Keyword
),Punctuation
 ,Whitespace
{,Punctuation
                     ,Whitespace
// until MAPREDUCE-476,Comment
"
",Newline
        ,Whitespace
URI,Identifier
[,Punctuation
],Punctuation
 ,Whitespace
files,Identifier
 ,Whitespace
=,Operator
 ,Whitespace
DistributedCache,Identifier
.,Punctuation
getCacheFiles,Identifier
(,Punctuation
job,Identifier
),Punctuation
;,Punctuation
"
",Newline
        ,Whitespace
localFiles,Identifier
 ,Whitespace
=,Operator
 ,Whitespace
new,Keyword
 ,Whitespace
Path,Identifier
[,Punctuation
],Punctuation
 ,Whitespace
{,Punctuation
 ,Whitespace
new,Keyword
 ,Whitespace
Path,Identifier
(,Punctuation
files,Identifier
[,Punctuation
0,Literal
],Punctuation
.,Punctuation
toString,Identifier
(,Punctuation
),Punctuation
),Punctuation
 ,Whitespace
},Punctuation
;,Punctuation
"
",Newline
      ,Whitespace
},Punctuation
"
",Newline
      ,Whitespace
executable,Identifier
=,Operator
localFiles,Identifier
[,Punctuation
0,Literal
],Punctuation
.,Punctuation
toString,Identifier
(,Punctuation
),Punctuation
;,Punctuation
"
",Newline
      ,Whitespace
FileUtil,Identifier
.,Punctuation
chmod,Identifier
(,Punctuation
executable,Identifier
.,Punctuation
toString,Identifier
(,Punctuation
),Punctuation
",",Punctuation
 ,Whitespace
"""a+x""",String
),Punctuation
;,Punctuation
"
",Newline
    ,Whitespace
},Punctuation
"
",Newline
    ,Whitespace
else,Keyword
 ,Whitespace
{,Punctuation
"
",Newline
      ,Whitespace
executable,Identifier
=,Operator
job,Identifier
.,Punctuation
get,Identifier
(,Punctuation
TetherJob,Identifier
.,Punctuation
TETHER_EXEC,Identifier
),Punctuation
;,Punctuation
"
",Newline
    ,Whitespace
},Punctuation
"
",Newline
"
",Newline
    ,Whitespace
command,Identifier
.,Punctuation
add,Identifier
(,Punctuation
executable,Identifier
),Punctuation
;,Punctuation
"
",Newline
"
",Newline
    ,Whitespace
// Add the executable arguments. We assume the arguments are separated by,Comment
"
",Newline
    ,Whitespace
// spaces so we split the argument string based on spaces and add each,Comment
"
",Newline
    ,Whitespace
// token to command We need to do it this way because,Comment
"
",Newline
    ,Whitespace
// TaskLog.captureOutAndError will put quote marks around each argument so,Comment
"
",Newline
    ,Whitespace
// if we pass a single string containing all arguments we get quoted,Comment
"
",Newline
    ,Whitespace
// incorrectly,Comment
"
",Newline
    ,Whitespace
String,Identifier
 ,Whitespace
args,Identifier
=,Operator
job,Identifier
.,Punctuation
get,Identifier
(,Punctuation
TetherJob,Identifier
.,Punctuation
TETHER_EXEC_ARGS,Identifier
),Punctuation
;,Punctuation
"
",Newline
    ,Whitespace
String,Identifier
[,Punctuation
],Punctuation
 ,Whitespace
aparams,Identifier
=,Operator
args,Identifier
.,Punctuation
split,Identifier
(,Punctuation
"""\n""",String
),Punctuation
;,Punctuation
"
",Newline
    ,Whitespace
for,Keyword
 ,Whitespace
(,Punctuation
int,Keyword
 ,Whitespace
i,Identifier
=,Operator
0,Literal
;,Punctuation
i,Identifier
<,Operator
aparams,Identifier
.,Punctuation
length,Identifier
;,Punctuation
 ,Whitespace
i,Identifier
++,Operator
),Punctuation
{,Punctuation
            ,Whitespace
"
",Newline
      ,Whitespace
aparams,Identifier
[,Punctuation
i,Identifier
],Punctuation
=,Operator
aparams,Identifier
[,Punctuation
i,Identifier
],Punctuation
.,Punctuation
trim,Identifier
(,Punctuation
),Punctuation
;,Punctuation
"
",Newline
      ,Whitespace
if,Keyword
 ,Whitespace
(,Punctuation
aparams,Identifier
[,Punctuation
i,Identifier
],Punctuation
.,Punctuation
length,Identifier
(,Punctuation
),Punctuation
>,Operator
0,Literal
),Punctuation
{,Punctuation
"
",Newline
        ,Whitespace
command,Identifier
.,Punctuation
add,Identifier
(,Punctuation
aparams,Identifier
[,Punctuation
i,Identifier
],Punctuation
),Punctuation
;,Punctuation
"
",Newline
      ,Whitespace
},Punctuation
"
",Newline
    ,Whitespace
},Punctuation
"
",Newline
"
",Newline
    ,Whitespace
if,Keyword
 ,Whitespace
(,Punctuation
System,Identifier
.,Punctuation
getProperty,Identifier
(,Punctuation
"""hadoop.log.dir""",String
),Punctuation
 ,Whitespace
==,Operator
 ,Whitespace
null,Keyword
"
",Newline
        ,Whitespace
&&,Operator
 ,Whitespace
System,Identifier
.,Punctuation
getenv,Identifier
(,Punctuation
"""HADOOP_LOG_DIR""",String
),Punctuation
 ,Whitespace
!=,Operator
 ,Whitespace
null,Keyword
),Punctuation
"
",Newline
      ,Whitespace
System,Identifier
.,Punctuation
setProperty,Identifier
(,Punctuation
"""hadoop.log.dir""",String
",",Punctuation
 ,Whitespace
System,Identifier
.,Punctuation
getenv,Identifier
(,Punctuation
"""HADOOP_LOG_DIR""",String
),Punctuation
),Punctuation
;,Punctuation
"
",Newline
"
",Newline
    ,Whitespace
// wrap the command in a stdout/stderr capture,Comment
"
",Newline
    ,Whitespace
TaskAttemptID,Identifier
 ,Whitespace
taskid,Identifier
 ,Whitespace
=,Operator
 ,Whitespace
TaskAttemptID,Identifier
.,Punctuation
forName,Identifier
(,Punctuation
job,Identifier
.,Punctuation
get,Identifier
(,Punctuation
"""mapred.task.id""",String
),Punctuation
),Punctuation
;,Punctuation
"
",Newline
    ,Whitespace
File,Identifier
 ,Whitespace
stdout,Identifier
 ,Whitespace
=,Operator
 ,Whitespace
TaskLog,Identifier
.,Punctuation
getTaskLogFile,Identifier
(,Punctuation
taskid,Identifier
",",Punctuation
 ,Whitespace
false,Keyword
",",Punctuation
 ,Whitespace
TaskLog,Identifier
.,Punctuation
LogName,Identifier
.,Punctuation
STDOUT,Identifier
),Punctuation
;,Punctuation
"
",Newline
    ,Whitespace
File,Identifier
 ,Whitespace
stderr,Identifier
 ,Whitespace
=,Operator
 ,Whitespace
TaskLog,Identifier
.,Punctuation
getTaskLogFile,Identifier
(,Punctuation
taskid,Identifier
",",Punctuation
 ,Whitespace
false,Keyword
",",Punctuation
 ,Whitespace
TaskLog,Identifier
.,Punctuation
LogName,Identifier
.,Punctuation
STDERR,Identifier
),Punctuation
;,Punctuation
"
",Newline
    ,Whitespace
long,Keyword
 ,Whitespace
logLength,Identifier
 ,Whitespace
=,Operator
 ,Whitespace
TaskLog,Identifier
.,Punctuation
getTaskLogLength,Identifier
(,Punctuation
job,Identifier
),Punctuation
;,Punctuation
"
",Newline
    ,Whitespace
command,Identifier
 ,Whitespace
=,Operator
 ,Whitespace
TaskLog,Identifier
.,Punctuation
captureOutAndError,Identifier
(,Punctuation
null,Keyword
",",Punctuation
 ,Whitespace
command,Identifier
",",Punctuation
 ,Whitespace
stdout,Identifier
",",Punctuation
 ,Whitespace
stderr,Identifier
",",Punctuation
 ,Whitespace
logLength,Identifier
",",Punctuation
 ,Whitespace
false,Keyword
),Punctuation
;,Punctuation
"
",Newline
    ,Whitespace
stdout,Identifier
.,Punctuation
getParentFile,Identifier
(,Punctuation
),Punctuation
.,Punctuation
mkdirs,Identifier
(,Punctuation
),Punctuation
;,Punctuation
"
",Newline
    ,Whitespace
stderr,Identifier
.,Punctuation
getParentFile,Identifier
(,Punctuation
),Punctuation
.,Punctuation
mkdirs,Identifier
(,Punctuation
),Punctuation
;,Punctuation
"
",Newline
"
",Newline
    ,Whitespace
// add output server's port to env,Comment
"
",Newline
    ,Whitespace
Map,Identifier
<,Operator
String,Identifier
",",Punctuation
 ,Whitespace
String,Identifier
>,Operator
 ,Whitespace
env,Identifier
 ,Whitespace
=,Operator
 ,Whitespace
new,Keyword
 ,Whitespace
HashMap,Identifier
<,Operator
String,Identifier
",",Punctuation
String,Identifier
>,Operator
(,Punctuation
),Punctuation
;,Punctuation
"
",Newline
    ,Whitespace
env,Identifier
.,Punctuation
put,Identifier
(,Punctuation
"""AVRO_TETHER_OUTPUT_PORT""",String
",",Punctuation
"
",Newline
            ,Whitespace
Integer,Identifier
.,Punctuation
toString,Identifier
(,Punctuation
outputServer,Identifier
.,Punctuation
getPort,Identifier
(,Punctuation
),Punctuation
),Punctuation
),Punctuation
;,Punctuation
"
",Newline
"
",Newline
    ,Whitespace
// start child process,Comment
"
",Newline
    ,Whitespace
ProcessBuilder,Identifier
 ,Whitespace
builder,Identifier
 ,Whitespace
=,Operator
 ,Whitespace
new,Keyword
 ,Whitespace
ProcessBuilder,Identifier
(,Punctuation
command,Identifier
),Punctuation
;,Punctuation
"
",Newline
    ,Whitespace
System,Identifier
.,Punctuation
out,Identifier
.,Punctuation
println,Identifier
(,Punctuation
command,Identifier
),Punctuation
;,Punctuation
"
",Newline
    ,Whitespace
builder,Identifier
.,Punctuation
environment,Identifier
(,Punctuation
),Punctuation
.,Punctuation
putAll,Identifier
(,Punctuation
env,Identifier
),Punctuation
;,Punctuation
"
",Newline
    ,Whitespace
return,Keyword
 ,Whitespace
builder,Identifier
.,Punctuation
start,Identifier
(,Punctuation
),Punctuation
;,Punctuation
"
",Newline
  ,Whitespace
},Punctuation
"
",Newline
  ,Whitespace
"
",Newline
},Punctuation
"
",Newline
